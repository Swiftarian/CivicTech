# 台東防災館綜合管理系統 - 功能清單

## 核心系統功能
- [x] 資料庫結構設計與建立
- [x] 使用者認證系統（管理員、志工、民眾三種角色）
- [x] 權限管理系統
- [x] 角色型存取控制（RBAC）

## 模組一：導覽預約與排班管理
- [x] 團體預約功能（20-50人）
- [x] 一般民眾預約功能（1-19人）
- [x] 預約日曆顯示與時段管理
- [x] 預約查詢功能
- [x] 志工排班管理
- [x] 志工指派系統
- [x] 志工班表查看
- [x] 志工打卡功能
- [x] 換班申請功能
- [x] 請假申請功能
- [x] 服務時數統計

## 模組二：案件查詢與進度通知
- [x] 案件申請表單
- [x] 案件進度查詢
- [x] 案件狀態管理
- [x] 進度通知系統
- [x] 案件歷史記錄

## 模組三：送餐服務與路徑追蹤
- [x] 送餐任務建立
- [x] 送餐志工指派
- [x] 路徑規劃與追蹤
- [x] QR Code 掃描驗證
- [x] 送達確認機制
- [x] 送餐歷史記錄

## 前端介面
- [x] 首頁設計（含輪播圖）
- [x] 導覽列與選單
- [x] 管理員後台儀表板
- [ ] 志工專區介面
- [x] 民眾預約介面
- [x] 交通指引頁面
- [x] 響應式設計（手機、平板、桌面）

## 測試與優化
- [x] API 單元測試
- [ ] 前端功能測試
- [ ] 效能優化
- [ ] 安全性檢查
- [ ] 使用者體驗優化

## 部署與文件
- [ ] 系統文件撰寫
- [ ] 使用者手冊
- [ ] 建立初始檢查點

## 錯誤修正
- [x] 修正首頁中嵌套anchor標籤的錯誤

## 新增功能
- [x] 建立交通指引頁面
- [x] 建立送餐服務管理介面（管理員）
- [ ] 建立送餐服務志工介面
- [x] 實現QR Code生成與掃描功能
- [x] 建立送餐服務使用說明文件
- [x] 更新管理員後台添加送餐服務管理的實際連結

## 部署後問題修復
- [x] 診斷並修復登入後台錯誤
- [x] 建立完整的 README.md 文件
- [x] 推送專案到 GitHub 倉庫
- [x] 建立志工管理和請假系統使用說明文件
- [x] 在管理員後台添加志工管理功能介面（新增、查看、編輯志工）
- [x] 優化志工新增功能：改為從使用者列表下拉選單選擇，而非手動輸入ID
- [x] 開發Excel志工表單上傳功能
- [x] 建立Excel範本檔案供管理員下載
- [x] 實作批次匯入志工資料API
- [x] 建立前端上傳介面和進度顯示

## 功能改進
- [x] Excel匯入功能：新增匯入結果預覽彈出視窗
- [x] 顯示成功匯入的志工詳細資訊
- [x] 顯示失敗記錄及錯誤原因

## 問題修復
- [ ] 診斷Excel匯入功能的管理員權限問題
- [ ] 確認使用者Huanchenlin@gmail.com的管理員權限設定
- [ ] 修復權限檢查邏輯或設定使用者為管理員

## 請假審核通知功能開發
- [x] 實作系統內通知功能（審核後發送通知給申請志工）
- [x] 實作Email通知功能（寄送審核結果通知信）
- [x] 整合通知到請假審核流程（核准/拒絕時自動發送）
- [x] 建立前端通知顯示介面（通知列表、未讀標記）
- [x] 撰寫通知功能的單元測試

## 志工管理功能增強
- [x] 實作後端編輯志工API
- [x] 實作後端刪除志工API
- [x] 建立編輯志工對話框組件
- [x] 在志工列表中新增編輯和刪除按鈕
- [x] 新增刪除確認對話框
- [x] 撰寫編輯和刪除功能的單元測試

## 首頁設計調整
- [x] 移除「年度參訪人次」和「專業志工」統計區塊
- [x] 將整體配色改為蘋果綠主題
- [x] 優化banner設計風格

## Banner設計簡化
- [x] 將banner背景改為白色或淺色，減少綠色使用
- [x] 參考簡潔設計風格優化banner布局

## 頁尾和導覽列配色調整
- [x] 將頁尾深綠色背景改為淺色
- [x] 將導覽列深綠色背景改為淺色或白色
- [x] 確保整體配色協調美觀

## 首頁內容更新
- [ ] 更新「關於台東防災館」區塊的介紹文字為150字文案

## Railway部署準備
- [x] 建立Railway部署配置檔案
- [x] 撰寫完整的部署指南文件
- [x] 準備環境變數清單

## 移除Manus標記
- [ ] 搜尋並移除「Made with Manus」標記

## 更新地址和地圖
- [x] 更新交通指引頁面的Google Maps地圖
- [x] 更新首頁和頁尾的地址資訊
- [x] 設定正確的地圖中心點和標記

## 預約Email通知功能
- [x] 修改預約API整合Email通知
- [x] 撰寫民眾預約確認信範本
- [x] 撰寫團體預約確認信範本
- [x] 測試Email發送功能

## 預約提醒排程任務功能
- [x] 設計參訪前3天提醒Email範本
- [x] 建立排程任務檢查即將到來的預約
- [x] 實作自動發送提醒Email功能
- [x] 記錄已發送提醒的預約（避免重複發送）
- [x] 撰寫單元測試
- [x] 撰寫功能說明文件

## Email通知測試頁面
- [x] 建立Email測試頁面UI
- [x] 新增測試預約確認Email的API
- [x] 新增測試預約提醒Email的API
- [x] 整合到管理員後台

## Gmail SMTP整合
- [x] 安裝nodemailer套件
- [ ] 設定SMTP環境變數
- [x] 修改emailService.ts整合Gmail SMTP
- [ ] 測試真實Email發送

## Email發送歷史記錄
- [x] 建立emailLogs資料表
- [x] 新增記錄Email發送的函數
- [x] 修改所有Email發送函數記錄歷史
- [x] 新增查詢Email歷史的API

## 管理員後台Email測試入口
- [ ] 在管理員儀表板側邊欄新增Email測試選項
- [x] 在Email測試頁面顯示發送歷史記錄
- [x] 新增統計和視覺化顯示

## SMTP真實Email發送設定
- [x] 請求用戶提供SMTP憑證
- [x] 驗證SMTP連線
- [x] 測試真實Email發送
- [x] 撰寫SMTP設定驗證測試

## 送餐路徑追蹤功能
- [x] 建立路徑追蹤後端API（上傳GPS位置、查詢路徑記錄）
- [x] 建立即時地圖追蹤頁面（管理員查看志工當前位置）
- [x] 建立歷史路徑回放功能（查看已完成任務的完整路徑）
- [x] 建立志工端GPS上傳頁面（志工送餐時自動上傳位置）
- [x] 整合Google Maps顯示路徑軌跡
- [x] 撰寫單元測試

## 送餐路線優化功能
- [x] 建立批量匯入送餐地址功能（文字輸入）
- [x] 整合Google Maps Directions API
- [x] 開發路線優化演算法（7個點的最佳順序）
- [ ] 在管理員頁面顯示優化後的路線
- [ ] 在志工頁面顯示優化後的配送順序

## 送達驗證系統
- [x] 開發拍照上傳功能
- [x] 開發驗證碼輸入驗證
- [x] 開發GPS定位驗證（20公尺誤差範圍）
- [x] 整合多種驗證方式到送達確認流程
- [x] 撰寫單元測試

## 志工配送數據分析儀表板
- [x] 建立志工績效統計API（送餐次數、平均配送時間、準時率）
- [x] 建立志工排名API（依送餐次數、準時率排序）
- [x] 建立志工績效儀表板UI頁面
- [x] 整合圖表庫（Recharts）顯示統計數據
- [x] 撰寫單元測試

## 收餐人QR Code確認功能
- [x] 為每筆送餐任務生成專屬QR Code
- [x] 建立收餐人掃描確認頁面
- [x] 整合QR Code顯示到志工送餐頁面
- [x] 記錄收餐人確認時間和位置
- [x] 撰寫單元測試

## SMS簡訊通知和序號驗證簽收流程
- [x] 為送餐任務自動產生唯一序號
- [x] 建立SMS簡訊發送服務（模擬模式）
- [x] 建立送餐任務時自動發送SMS通知收餐人
- [x] 修改收餐人確認頁面支援序號驗證
- [x] 修改志工送餐頁面顯示序號給收餐人
- [x] 記錄完整簽收流程（序號驗證、時間、GPS）
- [x] 撰寫單元測試

## SMS簡訊測試功能
- [x] 建立SMS測試API（管理員專用）
- [x] 建立SMS測試頁面UI
- [x] 顯示SMS發送模擬內容
- [x] 撰寫SMS測試使用說明文件

## Twilio SMS真實簡訊整合
- [ ] 安裝Twilio套件
- [ ] 修改smsService.ts整合Twilio API
- [ ] 設定Twilio環境變數（TWILIO_ACCOUNT_SID、TWILIO_AUTH_TOKEN、TWILIO_FROM_NUMBER）
- [ ] 測試真實SMS發送功能
- [ ] 撰寫Twilio整合驗證測試

## 資安掃描準備
- [ ] 準備原始碼壓縮檔（排除node_modules等）
- [ ] 建立測試用管理員帳號
- [ ] 準備弱點掃描測試環境資訊
- [ ] 撰寫資安掃描說明文件
